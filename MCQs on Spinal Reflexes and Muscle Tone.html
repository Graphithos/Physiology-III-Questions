<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCQs on Physiology 3 Lecture No.5 Quiz</title>
    <style>
        :root {
            --bg-color: #f5f7fa;
            --container-bg: white;
            --text-color: #333;
            --border-color: #ddd;
            --primary-color: #3498db;
            --header-color: #2c3e50;
            --secondary-text: #7f8c8d;
            --progress-bg: #ecf0f1;
            --question-bg: #f8f9fa;
            --option-bg: #fff;
            --option-hover: #f1f8ff;
            --option-selected: #d1ecf1;
            --correct-bg: #d4edda;
            --correct-border: #28a745;
            --incorrect-bg: #f8d7da;
            --incorrect-border: #dc3545;
            --button-bg: #3498db;
            --button-hover: #2980b9;
            --button-disabled: #bdc3c7;
            --restart-bg: #2ecc71;
            --restart-hover: #27ae60;
            --review-bg: #f39c12;
            --review-hover: #e67e22;
            --toggle-bg: #ecf0f1;
            --toggle-slider: white;
            --toggle-text: #7f8c8d;
        }

        .dark-mode {
            --bg-color: #1a1a2e;
            --container-bg: #16213e;
            --text-color: #e6e6e6;
            --border-color: #394867;
            --primary-color: #4cc9f0;
            --header-color: #e6e6e6;
            --secondary-text: #a9a9a9;
            --progress-bg: #394867;
            --question-bg: #1f4068;
            --option-bg: #16213e;
            --option-hover: #1f4068;
            --option-selected: #1f4068;
            --correct-bg: #2d5a2d;
            --correct-border: #4caf50;
            --incorrect-bg: #5a2d2d;
            --incorrect-border: #f44336;
            --button-bg: #4cc9f0;
            --button-hover: #3aa8d0;
            --button-disabled: #5d6d7e;
            --restart-bg: #2ecc71;
            --restart-hover: #27ae60;
            --review-bg: #f39c12;
            --review-hover: #e67e22;
            --toggle-bg: #394867;
            --toggle-slider: #4cc9f0;
            --toggle-text: #e6e6e6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--container-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
            position: relative;
        }
        h1 {
            color: var(--header-color);
            margin-bottom: 5px;
            font-size: 24px;
            transition: color 0.3s;
        }
        .author {
            color: var(--secondary-text);
            font-style: italic;
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        .description {
            color: var(--secondary-text);
            margin-bottom: 20px;
            transition: color 0.3s;
        }
        .theme-toggle {
            position: absolute;
            top: 35px; /* Adjusted to align with author name */
            right: 0;
            display: flex;
            align-items: center;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 120px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--toggle-bg);
            transition: .4s;
            border-radius: 34px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            font-size: 12px;
            font-weight: bold;
            color: var(--toggle-text);
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 60px;
            left: 4px;
            bottom: 4px;
            background-color: var(--toggle-slider);
            transition: .4s;
            border-radius: 34px;
            z-index: 1;
        }
        .slider-text {
            position: relative;
            z-index: 2;
            width: 100%;
            display: flex;
            justify-content: space-between;
        }
        .light-text, .dark-text {
            transition: opacity 0.3s;
        }
        .dark-mode .light-text {
            opacity: 0.5;
        }
        .light-text {
            opacity: 0.5;
        }
        .dark-mode .dark-text {
            opacity: 1;
        }
        .dark-text {
            opacity: 0.5;
        }
        input:checked + .slider:before {
            transform: translateX(52px);
        }
        .progress-container {
            background: var(--progress-bg);
            border-radius: 5px;
            margin-bottom: 20px;
            position: relative;
            height: 10px;
            transition: background-color 0.3s;
        }
        .progress-bar {
            height: 100%;
            background: var(--primary-color);
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s ease, background-color 0.3s;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            color: var(--header-color);
            transition: color 0.3s;
        }
        .question {
            background: var(--question-bg);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: background-color 0.3s;
        }
        .question-number {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        .question-text {
            font-size: 18px;
            margin-bottom: 15px;
        }
        .options {
            display: grid;
            grid-gap: 10px;
        }
        .option {
            padding: 12px 15px;
            background: var(--option-bg);
            border: 2px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .option:hover {
            background: var(--option-hover);
            border-color: var(--primary-color);
        }
        .option.selected {
            background: var(--option-selected);
            border-color: var(--primary-color);
        }
        .option.correct {
            background: var(--correct-bg);
            border-color: var(--correct-border);
        }
        .option.incorrect {
            background: var(--incorrect-bg);
            border-color: var(--incorrect-border);
        }
        .feedback {
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            display: none;
        }
        .feedback.correct {
            background: var(--correct-bg);
            color: var(--text-color);
            border: 1px solid var(--correct-border);
            display: block;
        }
        .feedback.incorrect {
            background: var(--incorrect-bg);
            color: var(--text-color);
            border: 1px solid var(--incorrect-border);
            display: block;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        button {
            padding: 10px 20px;
            background: var(--button-bg);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        button:hover {
            background: var(--button-hover);
        }
        button:disabled {
            background: var(--button-disabled);
            cursor: not-allowed;
        }
        .results {
            text-align: center;
            padding: 30px;
            display: none;
        }
        .score {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--header-color);
        }
        .score-value {
            font-size: 48px;
            color: var(--primary-color);
            font-weight: bold;
        }
        .restart-btn {
            margin-top: 20px;
            background: var(--restart-bg);
        }
        .restart-btn:hover {
            background: var(--restart-hover);
        }
        .review-btn {
            margin-top: 20px;
            background: var(--review-bg);
        }
        .review-btn:hover {
            background: var(--review-hover);
        }
        .review-section {
            margin-top: 30px;
            padding: 20px;
            background: var(--question-bg);
            border-radius: 8px;
            display: none;
        }
        .review-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--header-color);
            text-align: center;
        }
        .review-question {
            margin-bottom: 20px;
            padding: 15px;
            border-left: 4px solid var(--incorrect-border);
            background: var(--container-bg);
            border-radius: 4px;
        }
        .review-question-number {
            font-weight: bold;
            color: var(--incorrect-border);
            margin-bottom: 8px;
        }
        .review-question-text {
            margin-bottom: 10px;
        }
        .review-answer {
            margin-top: 8px;
            font-weight: bold;
        }
        .review-correct {
            color: var(--correct-border);
        }
        .review-explanation {
            margin-top: 5px;
            font-style: italic;
            color: var(--secondary-text);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MCQs on Physiology 3 Lecture No.5 Quiz</h1>
            <p class="author">Dr. Samy Salem</p>
            <p class="description">Test your knowledge of Physiology 3 (Reflexes)</p>
            <div class="theme-toggle">
                <label class="switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider">
                        <div class="slider-text">
                            <span class="light-text">Light</span>
                            <span class="dark-text">Dark</span>
                        </div>
                    </span>
                </label>
            </div>
        </header>

        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="stats">
            <div>Question: <span id="current-question">1</span>/<span id="total-questions">30</span></div>
            <div>Score: <span id="score">0</span>/<span id="total-score">30</span></div>
        </div>

        <div id="quiz-container">
            <!-- Questions will be inserted here by JavaScript -->
        </div>

        <div class="navigation">
            <button id="prev-btn" disabled>Previous</button>
            <button id="next-btn">Next</button>
        </div>

        <div id="results" class="results">
            <div class="score">Your Score: <span class="score-value" id="final-score">0</span>/30</div>
            <p id="performance-message"></p>
            <button class="restart-btn" id="restart-btn">Restart Quiz</button>
            <button class="review-btn" id="review-btn">Review Incorrect Answers</button>
        </div>

        <div id="review-section" class="review-section">
            <h2 class="review-title">Questions Answered Incorrectly</h2>
            <div id="incorrect-questions-list"></div>
        </div>
    </div>

    <script>
        // Quiz data (all 30 questions from the PDF)
        const quizData = [
            {
                question: "What is the definition of a reflex?",
                options: [
                    "A slow, voluntary motor response to external stimuli",
                    "A rapid, predictable, involuntary motor response to stimuli",
                    "A conscious decision to move a body part",
                    "A learned movement pattern"
                ],
                answer: 1,
                explanation: "A rapid, predictable, involuntary motor response to stimuli (Page 5)"
            },
            {
                question: "Which level of the motor control hierarchy contains the spinal cord?",
                options: [
                    "Highest (precommand) level",
                    "Middle level",
                    "Lowest level",
                    "Projection level"
                ],
                answer: 2,
                explanation: "Lowest level (Page 3)"
            },
            {
                question: "What are the two main types of reflexes?",
                options: [
                    "Monosynaptic and polysynaptic",
                    "Spinal and cranial",
                    "Autonomic and somatic",
                    "Dynamic and static"
                ],
                answer: 2,
                explanation: "Autonomic and somatic (Page 5)"
            },
            {
                question: "How many synapses are present in a monosynaptic reflex arc?",
                options: [
                    "None",
                    "One",
                    "Two or more",
                    "Multiple"
                ],
                answer: 1,
                explanation: "One (Page 7)"
            },
            {
                question: "What is the primary sensory receptor for the stretch reflex?",
                options: [
                    "Golgi tendon organ",
                    "Pacinian corpuscle",
                    "Free nerve ending",
                    "Muscle spindle"
                ],
                answer: 3,
                explanation: "Muscle spindle (Page 12)"
            },
            {
                question: "Which type of intrafusal muscle fiber is supplied by both primary and secondary afferents?",
                options: [
                    "Both nuclear bag and nuclear chain fibers",
                    "Nuclear bag fibers only",
                    "Nuclear chain fibers only",
                    "Extrafusal fibers"
                ],
                answer: 0,
                explanation: "Both nuclear bag and nuclear chain fibers (Page 13)"
            },
            {
                question: "What is the neurotransmitter released at the synapse in the stretch reflex pathway?",
                options: [
                    "Acetylcholine",
                    "GABA",
                    "Glutamate",
                    "Glycine"
                ],
                answer: 2,
                explanation: "Glutamate (Page 15)"
            },
            {
                question: "Which efferent neurons innervate intrafusal muscle fibers?",
                options: [
                    "Gamma motor neurons",
                    "Alpha motor neurons",
                    "Beta motor neurons",
                    "Delta motor neurons"
                ],
                answer: 0,
                explanation: "Gamma motor neurons (Page 14, 22)"
            },
            {
                question: "What is the function of alpha-gamma coactivation?",
                options: [
                    "To inhibit muscle contraction",
                    "To maintain muscle spindle sensitivity during muscle contraction",
                    "To prevent reciprocal inhibition",
                    "To increase Golgi tendon organ activity"
                ],
                answer: 1,
                explanation: "To maintain muscle spindle sensitivity during muscle contraction (Page 30)"
            },
            {
                question: "What is the neural center for the patellar tendon reflex?",
                options: [
                    "C5-C6",
                    "C6-C7-C8",
                    "L2-L3-L4",
                    "S1-S2"
                ],
                answer: 2,
                explanation: "L2-L3-L4 (Page 34)"
            },
            {
                question: "What type of reflex is the tendon jerk (deep tendon reflex)?",
                options: [
                    "Dynamic stretch reflex",
                    "Static stretch reflex",
                    "Inverse stretch reflex",
                    "Flexor reflex"
                ],
                answer: 0,
                explanation: "Dynamic stretch reflex (Page 21, 32)"
            },
            {
                question: "Which reflex is responsible for preventing damage from excessive muscle tension?",
                options: [
                    "Stretch reflex",
                    "Crossed extensor reflex",
                    "Golgi tendon reflex",
                    "Flexor reflex"
                ],
                answer: 2,
                explanation: "Golgi tendon reflex (Page 41)"
            },
            {
                question: "During the stretch reflex, what happens to antagonist muscles?",
                options: [
                    "They contract strongly",
                    "They are damped (reciprocal inhibition)",
                    "They remain unaffected",
                    "They exhibit clonus"
                ],
                answer: 1,
                explanation: "They are damped (reciprocal inhibition) (Page 19)"
            },
            {
                question: "Which reflex involves flexion withdrawal of a limb and extension of the opposite limb?",
                options: [
                    "Stretch reflex",
                    "Crossed extensor reflex",
                    "Golgi tendon reflex",
                    "Positive supporting reflex"
                ],
                answer: 1,
                explanation: "Crossed extensor reflex (Page 49)"
            },
            {
                question: "What is the stimulus for the flexor (withdrawal) reflex?",
                options: [
                    "Muscle stretch",
                    "Excessive tension",
                    "Joint compression",
                    "Nociceptive (painful) stimulus"
                ],
                answer: 3,
                explanation: "Nociceptive (painful) stimulus (Page 47)"
            },
            {
                question: "Which reflex results in contraction of both flexor and extensor muscles of the lower limb in response to foot pad pressure?",
                options: [
                    "Crossed extensor reflex",
                    "Positive supporting reflex",
                    "Stretch reflex",
                    "Scratch reflex"
                ],
                answer: 1,
                explanation: "Positive supporting reflex (Page 50)"
            },
            {
                question: "What is the mechanism behind muscle tone?",
                options: [
                    "Dynamic stretch reflex",
                    "Static type of stretch reflex",
                    "Golgi tendon reflex",
                    "Crossed extensor reflex"
                ],
                answer: 1,
                explanation: "Static type of stretch reflex (Page 37)"
            },
            {
                question: "What is the spinal center for the biceps tendon reflex?",
                options: [
                    "C5-C6",
                    "C6-C7-C8",
                    "L2-L3-L4",
                    "S1-S2"
                ],
                answer: 0,
                explanation: "C5-C6 (Page 33)"
            },
            {
                question: "What is the spinal center for the Achilles tendon reflex?",
                options: [
                    "C5-C6",
                    "C6-C7-C8",
                    "L2-L3-L4",
                    "S1-S2"
                ],
                answer: 3,
                explanation: "S1-S2 (Page 34)"
            },
            {
                question: "Which of the following is NOT a function of muscle tone?",
                options: [
                    "Maintenance of erect posture",
                    "Assistance in venous return from lower limbs",
                    "Prevention of visceral ptosis",
                    "Increasing nerve conduction velocity"
                ],
                answer: 3,
                explanation: "Increasing nerve conduction velocity (Page 39)"
            },
            {
                question: "Which afferent fiber type comes from the primary ending of the muscle spindle?",
                options: [
                    "Type Ia fiber",
                    "Type Ib fiber",
                    "Type II fiber",
                    "Type III fiber"
                ],
                answer: 0,
                explanation: "Type Ia fiber (Page 14)"
            },
            {
                question: "Which afferent fiber type comes from the Golgi tendon organ?",
                options: [
                    "Type Ia fiber",
                    "Type Ib fiber",
                    "Type II fiber",
                    "Type III fiber"
                ],
                answer: 1,
                explanation: "Type Ib fiber (Page 41)"
            },
            {
                question: "Which brain structure is involved in facilitating muscle tone?",
                options: [
                    "Primary motor area 4",
                    "Red nucleus",
                    "Reticular formation inhibitory part",
                    "Premotor area 6"
                ],
                answer: 0,
                explanation: "Primary motor area 4 (Page 31)"
            },
            {
                question: "What is the purpose of reciprocal inhibition in reflex arcs?",
                options: [
                    "To contract both agonist and antagonist simultaneously",
                    "To prevent antagonist muscles from opposing the desired movement",
                    "To increase the strength of muscle contraction",
                    "To prolong the reflex response"
                ],
                answer: 1,
                explanation: "To prevent antagonist muscles from opposing the desired movement (Page 19, 46)"
            },
            {
                question: "Which characteristic allows the flexor reflex to spread to multiple muscles?",
                options: [
                    "Converging circuits",
                    "Reverberating circuits",
                    "Diverging circuits",
                    "Parallel circuits"
                ],
                answer: 2,
                explanation: "Diverging circuits (Page 48)"
            },
            {
                question: "Which reflex is tested clinically by stroking the sole of the foot?",
                options: [
                    "Abdominal reflex",
                    "Plantar reflex",
                    "Cremasteric reflex",
                    "Scratch reflex"
                ],
                answer: 1,
                explanation: "Plantar reflex (Page 53)"
            },
            {
                question: "How does the dynamic stretch reflex differ from the static stretch reflex?",
                options: [
                    "Dynamic is polysynaptic while static is monosynaptic",
                    "Dynamic responds to rapid stretch while static responds to slow stretch",
                    "Dynamic inhibits muscles while static excites them",
                    "Dynamic involves Golgi tendon organs while static involves muscle spindles"
                ],
                answer: 1,
                explanation: "Dynamic responds to rapid stretch while static responds to slow stretch (Page 21)"
            },
            {
                question: "What is the key difference between the stretch reflex and Golgi tendon reflex?",
                options: [
                    "Stretch reflex is inhibitory while Golgi tendon reflex is excitatory",
                    "Stretch reflex is polysynaptic while Golgi tendon reflex is monosynaptic",
                    "Stretch reflex uses type Ib afferents while Golgi tendon reflex uses type Ia afferents",
                    "Stretch reflex prevents stretching while Golgi tendon reflex prevents excessive tension"
                ],
                answer: 3,
                explanation: "Stretch reflex prevents stretching while Golgi tendon reflex prevents excessive tension (Page 15, 41)"
            },
            {
                question: "Which reflex primarily involves stimulation of gamma motor neurons?",
                options: [
                    "Static stretch reflex",
                    "Dynamic stretch reflex",
                    "Golgi tendon reflex",
                    "Crossed extensor reflex"
                ],
                answer: 0,
                explanation: "Static stretch reflex (Page 17)"
            },
            {
                question: "What is the fundamental purpose of most spinal reflexes?",
                options: [
                    "To generate conscious movement patterns",
                    "To provide rapid, protective responses to stimuli",
                    "To facilitate learning of new motor skills",
                    "To inhibit all muscle activity"
                ],
                answer: 1,
                explanation: "To provide rapid, protective responses to stimuli (Page 5)"
            }
        ];

        // Quiz state variables
        let currentQuestion = 0;
        let score = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let incorrectQuestions = [];

        // DOM elements
        const quizContainer = document.getElementById('quiz-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');
        const currentQuestionEl = document.getElementById('current-question');
        const totalQuestionsEl = document.getElementById('total-questions');
        const scoreEl = document.getElementById('score');
        const totalScoreEl = document.getElementById('total-score');
        const resultsContainer = document.getElementById('results');
        const finalScoreEl = document.getElementById('final-score');
        const performanceMessageEl = document.getElementById('performance-message');
        const restartBtn = document.getElementById('restart-btn');
        const reviewBtn = document.getElementById('review-btn');
        const reviewSection = document.getElementById('review-section');
        const incorrectQuestionsList = document.getElementById('incorrect-questions-list');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const lightText = document.querySelector('.light-text');
        const darkText = document.querySelector('.dark-text');

        // Initialize quiz
        function initQuiz() {
            totalQuestionsEl.textContent = quizData.length;
            totalScoreEl.textContent = quizData.length;
            showQuestion();
            updateProgressBar();
            
            // Initialize dark mode based on system preference
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode');
                darkModeToggle.checked = true;
                updateToggleText(true);
            } else {
                updateToggleText(false);
            }
            
            // Event listeners
            prevBtn.addEventListener('click', showPreviousQuestion);
            nextBtn.addEventListener('click', showNextQuestion);
            restartBtn.addEventListener('click', restartQuiz);
            reviewBtn.addEventListener('click', showIncorrectQuestions);
            darkModeToggle.addEventListener('change', toggleDarkMode);
        }

        // Toggle dark mode
        function toggleDarkMode() {
            const isDarkMode = darkModeToggle.checked;
            document.body.classList.toggle('dark-mode', isDarkMode);
            updateToggleText(isDarkMode);
        }

        // Update toggle text opacity
        function updateToggleText(isDarkMode) {
            if (isDarkMode) {
                lightText.style.opacity = '0.5';
                darkText.style.opacity = '1';
            } else {
                lightText.style.opacity = '1';
                darkText.style.opacity = '0.5';
            }
        }

        // Show current question
        function showQuestion() {
            currentQuestionEl.textContent = currentQuestion + 1;
            scoreEl.textContent = score;
            
            const question = quizData[currentQuestion];
            let optionsHTML = '';
            
            question.options.forEach((option, index) => {
                let optionClass = 'option';
                if (userAnswers[currentQuestion] === index) {
                    optionClass += ' selected';
                    if (index === question.answer) {
                        optionClass += ' correct';
                    } else {
                        optionClass += ' incorrect';
                    }
                }
                
                optionsHTML += `
                    <div class="${optionClass}" data-index="${index}">
                        ${String.fromCharCode(65 + index)}) ${option}
                    </div>
                `;
            });
            
            let feedbackHTML = '';
            if (userAnswers[currentQuestion] !== null) {
                const isCorrect = userAnswers[currentQuestion] === question.answer;
                feedbackHTML = `
                    <div class="feedback ${isCorrect ? 'correct' : 'incorrect'}">
                        ${isCorrect ? '✓ Correct!' : '✗ Incorrect!'} 
                        ${!isCorrect ? `Correct answer: ${String.fromCharCode(65 + question.answer)}) ${question.options[question.answer]}` : ''}
                        <br><br>Explanation: ${question.explanation}
                    </div>
                `;
            }
            
            quizContainer.innerHTML = `
                <div class="question">
                    <div class="question-number">Question ${currentQuestion + 1}/${quizData.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options">${optionsHTML}</div>
                    ${feedbackHTML}
                </div>
            `;
            
            // Add event listeners to options
            const optionElements = quizContainer.querySelectorAll('.option');
            optionElements.forEach(option => {
                option.addEventListener('click', selectOption);
            });
            
            // Update navigation buttons
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.textContent = currentQuestion === quizData.length - 1 ? 'Finish Quiz' : 'Next';
        }

        // Select an option
        function selectOption(e) {
            if (userAnswers[currentQuestion] !== null) return; // Already answered
            
            const selectedOption = e.currentTarget;
            const selectedIndex = parseInt(selectedOption.dataset.index);
            
            userAnswers[currentQuestion] = selectedIndex;
            
            // Check if answer is correct
            if (selectedIndex === quizData[currentQuestion].answer) {
                score++;
                scoreEl.textContent = score;
            } else {
                // Add to incorrect questions list
                incorrectQuestions.push({
                    question: quizData[currentQuestion].question,
                    userAnswer: selectedIndex,
                    correctAnswer: quizData[currentQuestion].answer,
                    options: quizData[currentQuestion].options,
                    explanation: quizData[currentQuestion].explanation,
                    questionNumber: currentQuestion + 1
                });
            }
            
            showQuestion();
            updateProgressBar();
        }

        // Show next question
        function showNextQuestion() {
            if (currentQuestion < quizData.length - 1) {
                currentQuestion++;
                showQuestion();
            } else {
                showResults();
            }
        }

        // Show previous question
        function showPreviousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const progress = ((currentQuestion + 1) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Show results
        function showResults() {
            quizContainer.style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            document.querySelector('.progress-container').style.display = 'none';
            document.querySelector('.stats').style.display = 'none';
            
            finalScoreEl.textContent = score;
            
            // Performance message
            const percentage = (score / quizData.length) * 100;
            let message = '';
            if (percentage >= 80) {
                message = 'Excellent! You have a strong understanding of Physiology 3 (Reflexes).';
            } else if (percentage >= 60) {
                message = 'Good job! You have a solid grasp of the material.';
            } else if (percentage >= 40) {
                message = 'Not bad! Review the material and try again.';
            } else {
                message = 'Keep studying! Review the lectures and try again.';
            }
            
            performanceMessageEl.textContent = message;
            resultsContainer.style.display = 'block';
            
            // Show review button only if there are incorrect answers
            if (incorrectQuestions.length > 0) {
                reviewBtn.style.display = 'inline-block';
            } else {
                reviewBtn.style.display = 'none';
            }
        }

        // Show incorrect questions
        function showIncorrectQuestions() {
            resultsContainer.style.display = 'none';
            reviewSection.style.display = 'block';
            
            let incorrectHTML = '';
            incorrectQuestions.forEach((item, index) => {
                incorrectHTML += `
                    <div class="review-question">
                        <div class="review-question-number">Question ${item.questionNumber}</div>
                        <div class="review-question-text">${item.question}</div>
                        <div>Your answer: ${String.fromCharCode(65 + item.userAnswer)}) ${item.options[item.userAnswer]}</div>
                        <div class="review-answer review-correct">Correct answer: ${String.fromCharCode(65 + item.correctAnswer)}) ${item.options[item.correctAnswer]}</div>
                        <div class="review-explanation">${item.explanation}</div>
                    </div>
                `;
            });
            
            incorrectQuestionsList.innerHTML = incorrectHTML;
        }

        // Restart quiz
        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            userAnswers = new Array(quizData.length).fill(null);
            incorrectQuestions = [];
            
            quizContainer.style.display = 'block';
            document.querySelector('.navigation').style.display = 'flex';
            document.querySelector('.progress-container').style.display = 'block';
            document.querySelector('.stats').style.display = 'flex';
            resultsContainer.style.display = 'none';
            reviewSection.style.display = 'none';
            
            showQuestion();
            updateProgressBar();
        }

        // Initialize the quiz when the page loads
        window.onload = initQuiz;
    </script>
</body>
</html>